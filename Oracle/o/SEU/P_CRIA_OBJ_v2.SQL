CREATE OR REPLACE PROCEDURE APLIC.P_CRIA_OBJ (own in varchar2, tab in varchar2)
IS
	str varchar2(4000);
	tab_name varchar2(128);
	
BEGIN
  SEU.P_GERA_DDL@DB1(UPPER(TAB));
  FOR RC1 IN (SELECT TABELA, DDL_TABELA FROM APLIC.DDL_TABELA@DB1 WHERE OWNER=UPPER(own) AND TABELA LIKE upper('%'||tab||'%'))
  LOOP
  	EXECUTE IMMEDIATE RC1.DDL_TABELA;
  	IF RC1.TABELA NOT LIKE '%LOG' THEN
  		EXECUTE IMMEDIATE 'GRANT SELECT ON '||OWN||'.'||RC1.TABELA||' TO R_'||OWN||'_READ';
  		EXECUTE IMMEDIATE 'GRANT SELECT,INSERT,UPDATE,DELETE ON '||OWN||'.'||RC1.TABELA||' TO R_'||OWN||'_ALL';
  	END IF;
  END LOOP;
  FOR RC2 IN (SELECT INDICE,DDL_INDICE FROM APLIC.DDL_INDICE@DB1 WHERE OWNER=UPPER(own) AND TABELA=UPPER(tab))
  LOOP
   	BEGIN
		 	EXECUTE IMMEDIATE RC2.DDL_INDICE;
		EXCEPTION WHEN OTHERS THEN
		 	DBMS_OUTPUT.PUT_LINE('ERRO AO CRIAR INDICE '||RC2.INDICE||' '||sqlerrm);
		END;
	END LOOP;
	FOR RC3 IN (SELECT SEQUENCE, DDL_SEQUENCE FROM APLIC.DDL_SEQUENCE@DB1 WHERE OWNER=UPPER(own) AND TABELA=UPPER(tab))
	LOOP
		BEGIN
			EXECUTE IMMEDIATE RC3.DDL_SEQUENCE;
		EXCEPTION WHEN OTHERS THEN
			DBMS_OUTPUT.PUT_LINE('ERRO AO CRIAR A SEQUENCE '||RC3.SEQUENCE||' DA TABELA '||tab||' '||SQLERRM);
		END;
	END LOOP;
	FOR RC4 IN (SELECT TRIGGER_NAME, DDL_TRIGGER FROM APLIC.DDL_TRIGGER@DB1 WHERE OWNER=UPPER(own) AND TABELA=UPPER(tab))
	LOOP
		BEGIN
			EXECUTE IMMEDIATE RC4.DDL_TRIGGER;
		EXCEPTION WHEN OTHERS THEN
			DBMS_OUTPUT.PUT_LINE('ERRO AO CRIAR A TRIGGER '||RC4.TRIGGER_NAME||' DA TABELA '||tab);
		END;
	END LOOP;
	P_UTL_RECOMP;
EXCEPTION WHEN OTHERS THEN
			P_UTL_RECOMP;
		 	RAISE_APPLICATION_ERROR(-20999,'ERRO AO CRIAR TABELA '||tab||' '||sqlerrm);
END;
/
	
			   