SET ECHO OFF
SET PAGES 0
SET LINES 200
SET FEEDBACK OFF
SET TIME OFF
SET TIMING OFF

SELECT '/*' 
  FROM DUAL
/

SET PAGESIZE 100 
SET HEADING ON

SELECT OWNER, OBJECT_TYPE, COUNT(*) 
  FROM DBA_OBJECTS
 WHERE OWNER IN('OWN_YMF','SYS_YMF','OWN_YMFBDG','SYS_YMFBDG','OWN_YMFGER','SYS_YMFGER')
 GROUP BY OWNER, OBJECT_TYPE
 ORDER BY OWNER, OBJECT_TYPE
/

SET PAGESIZE 0 
SET HEADING OFF

SELECT ' ' 
  FROM DUAL
/

SELECT '*/' 
  FROM DUAL
/

SELECT ' ' 
  FROM DUAL
/

select 'DROP '||OBJECT_TYPE||' '||OWNER||'.'||OBJECT_NAME||decode(object_type,'TABLE',' CASCADE CONSTRAINTS;',';')
From dba_objects
where owner IN('OWN_YMF','SYS_YMF','OWN_YMFBDG','SYS_YMFBDG','OWN_YMFGER','SYS_YMFGER')
AND OBJECT_TYPE NOT IN ('INDEX','PACKAGE BODY','TRIGGER')
ORDER BY OWNER, OBJECT_TYPE, OBJECT_NAME
/

SELECT ' ' 
  FROM DUAL
/

SELECT '-- VERIFICACAO DA REMOCAO DOS OBJETOS NA BASE DE DADOS [DESTINO]'
  FROM DUAL
/

SELECT 'SELECT OWNER, OBJECT_TYPE, COUNT(*) FROM DBA_OBJECTS'||CHR(10)||
       ' WHERE OWNER IN(''OWN_YMF'',''SYS_YMF'',''OWN_YMFBDG'',''SYS_YMFBDG'',''OWN_YMFGER'',''SYS_YMFGER'') '||CHR(10)||
       ' GROUP BY OWNER, OBJECT_TYPE  ORDER BY OWNER, OBJECT_TYPE;'
FROM DUAL
/

SELECT 'SPOOL OFF;' 
  FROM DUAL
/


SET TERM ON
SET FEEDBACK ON
SET VERIFY ON
SET ECHO ON
SET PAGESIZE 100 
SET HEADING ON
SET TIME ON
set timing oN
