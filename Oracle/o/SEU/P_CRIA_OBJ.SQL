CREATE OR REPLACE PROCEDURE APLIC.P_CRIA_OBJ (own in varchar2, tab in varchar2)
IS
	str varchar2(4000);
	tab_name varchar2(128);
	
BEGIN
  SEU.P_GERA_DDL@DB1(UPPER(TAB));
  SELECT TABELA, DDL_TABELA INTO tab_name,str FROM APLIC.DDL_TABELA@DB1 WHERE OWNER=UPPER(own) AND TABELA=UPPER(tab);
  EXECUTE IMMEDIATE str;
  FOR RC1 IN (SELECT INDICE,DDL_INDICE FROM APLIC.DDL_INDICE@DB1 WHERE OWNER=UPPER(own) AND TABELA=UPPER(tab))
  LOOP
   	BEGIN
		 	EXECUTE IMMEDIATE RC1.DDL_INDICE;
		EXCEPTION WHEN OTHERS THEN
		 	DBMS_OUTPUT.PUT_LINE('ERRO AO CRIAR INDICE '||RC1.INDICE||' '||sqlerrm);
		END;
	END LOOP;
	FOR RC2 IN (SELECT SEQUENCE, DDL_SEQUENCE FROM APLIC.DDL_SEQUENCE@DB1 WHERE OWNER=UPPER(own) AND TABELA=(tab))
	LOOP
		BEGIN
			SEU.P_CRIA_INCREMENTO(upper(tab));
			SEU.P_CRIA_LOG(upper(tab));
		EXCEPTION WHEN OTHERS THEN
		DBMS_OUTPUT.PUT_LINE('ERRO AO CRIAR LOG OU INCREMENTO DA TABELA '||tab_name);
	END;
EXCEPTION WHEN OTHERS THEN
		 	RAISE_APPLICATION_ERROR(-20999,'ERRO AO CRIAR TABELA '||tab||' '||sqlerrm);
END;
/
	
			   